<h1> <%= @q.title %> </h1>
<p> <%= @q.body %> </p>

<% if @q.user %>
<p>
  Created by:
  <!-- call to full_name method in user model -->
  <%= @q.user.full_name %>
</p>
<% end  %>
<!-- passes edit to 'can :manage, Question do |q|' -->
<% if can? :edit, @q %>
<%= link_to "Edit", edit_question_path(@q), class: "btn btn-info btn-sm" %>
<% end  %>
<% if can? :destroy, @q %>
<%= link_to("Delete", question_path(@q), {method: :delete,
                                          class: "btn btn-danger btn-sm",
                                          data: {confirm: "Are you sure?"}})%>
<% end  %>
  <h2>Submit an Answer</h2>

<!-- attach errors if any -->
  <%= @answer.errors.full_messages.join(", ") %>
<!-- without specifying the path helper it will try and submit to the answers_path
as it is following the standard rails conventions for CRUD
However we have nested the answers routes inside the questions routes
form_for @answer, the action will be answers_path if @answer is not persisted  in db
meaning its Answer.new. if @answer is persisted, the action will be answer_path(@answer)-->

<%#= form_for @answer, url: question_answers_path(@q) do |f| %>
<!-- passing the [@q, @answer] to the form helper generates the path action="/questions/:id/answers" for this form-->
<%= form_for [@q, @answer] do |f| %>  <!-- shortcut of above, benefit of using the answers routes nested within questions
note that @q must persist for this to work -->
<div class="form-group">
  <%= f.label :body %>
  <%= f.text_area :body, class: "form-control" %>
</div>
<div class="form-group">
  <%= f.submit class: "btn btn-primary" %>
</div>
  <% end %>

<h2>Answers</h2>
<% @q.answers.each do |answer|  %>
  <div class="well">
      <%= answer.body %>   <!-- Note: using answer for current answer, not @answer -->
    <% if(can? :destroy, answer) %> <!-- removed '|| (can? :destroy, @q)' -->
      <%= link_to "Delete", question_answer_path(@q, answer), method: :delete,
                          class: "btn btn-danger delete-right", data: {confirm: "Are you sure?"}%>
                            <!-- can also use 'pull-right' bootstrap class to float right-->
    <% end %>
  </div>
<% end  %>
